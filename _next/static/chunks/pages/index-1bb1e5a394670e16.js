(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{1300:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>F});var n=r(7876),i=r(4232),l=r(1040);let s=e=>{let{result:t,onClose:r}=e;return t?(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,n.jsxs)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"12px",width:"90%",maxWidth:"400px",textAlign:"center"},children:[(0,n.jsxs)("h3",{children:["생활유형: ",t.type]}),(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:t.title})}),(0,n.jsx)("p",{style:{marginTop:"1rem"},children:t.description}),(0,n.jsx)("h4",{children:"오늘의 마음 상태"}),Object.entries(t.scores).map(e=>{let[t,r]=e;return(0,n.jsxs)("div",{style:{margin:"0.5rem 0"},children:[(0,n.jsxs)("div",{style:{fontSize:"14px",textAlign:"left"},children:[t,": ",r]}),(0,n.jsx)("input",{type:"range",min:"0",max:"10",value:r,disabled:!0,style:{width:"100%"}})]},t)}),(0,n.jsx)("button",{onClick:r,style:{marginTop:"1rem"},children:"닫기"})]})}):null},a=e=>{let{onAdd:t,editingDiary:r}=e,[a,o]=(0,i.useState)(""),[d,c]=(0,i.useState)("기쁨"),[x,u]=(0,i.useState)(!1),[h,m]=(0,i.useState)(""),[p,j]=(0,i.useState)(null),[y,g]=(0,i.useState)(!1),[f,b]=(0,i.useState)(!1),[D,w]=(0,i.useState)(!1);(0,i.useEffect)(()=>{r?(o(r.text),c(r.emotion)):(o(""),c("기쁨")),b(!1),w(!1)},[r]);let v=async()=>{if(f)return void alert("이 일기에 대해 감정 추천은 이미 사용했습니다.");u(!0);try{let e=await l.A.post("/api/emotion",{text:a});c(e.data.emotion),b(!0)}catch(e){console.error("감정 분석 오류:",e.message)}finally{u(!1)}},C=async()=>{if(D)return void alert("이 일기에 대해 생활유형지수 분석은 이미 사용했습니다.");u(!0);try{let e=await l.A.post("/api/lbti",{text:a});j(e.data),g(!0),w(!0)}catch(e){console.error("LBTI 분석 오류:",e.message),alert("분석 실패! 다시 시도해주세요.")}finally{u(!1)}};return(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a&&d&&(t({text:a,emotion:d}),o(""),c("기쁨"),m(""),b(!1),w(!1))},children:[(0,n.jsx)("h2",{children:"오늘의 마음을 적어보세요"}),(0,n.jsx)("textarea",{rows:"4",placeholder:"내용 입력",value:a,onChange:e=>o(e.target.value),required:!0,style:{width:"100%",fontSize:"16px",marginBottom:"0.5rem"}}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"감정 선택: "}),(0,n.jsx)("select",{value:d,onChange:e=>c(e.target.value),required:!0,children:Object.entries({기쁨:"\uD83D\uDE0A",슬픔:"\uD83D\uDE22",화남:"\uD83D\uDE20",불안:"\uD83D\uDE28",사랑:"❤️",자신감:"\uD83D\uDE0E",눈물:"\uD83D\uDE2D",피곤함:"\uD83D\uDE34",당황:"\uD83D\uDE33",혐오:"\uD83E\uDD22",설렘:"\uD83D\uDE0D",불편함:"\uD83D\uDE2C",혼란:"\uD83E\uDD2F",평온함:"\uD83D\uDE07",고민중:"\uD83E\uDD14",위로:"\uD83E\uDD17",무감정:"\uD83D\uDE36",격노:"\uD83E\uDD2C"}).map(e=>{let[t,r]=e;return(0,n.jsxs)("option",{value:t,children:[t," ",r]},t)})})]}),(0,n.jsxs)("div",{style:{marginTop:"0.5rem",display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,n.jsx)("button",{type:"button",onClick:v,disabled:x||f,children:"\uD83E\uDDE0 감정 추천"}),(0,n.jsx)("button",{type:"button",onClick:C,disabled:x||D,children:"\uD83C\uDF08 생활유형지수 분석"}),(0,n.jsx)("button",{type:"submit",children:"✍️ 저장"})]}),y&&p&&(0,n.jsx)(s,{result:p,onClose:()=>g(!1)})]})};var o=r(3028),d=r.n(o);let c={기쁨:"\uD83D\uDE0A",슬픔:"\uD83D\uDE22",화남:"\uD83D\uDE20",불안:"\uD83D\uDE28",사랑:"❤️",자신감:"\uD83D\uDE0E",눈물:"\uD83D\uDE2D",피곤함:"\uD83D\uDE34",당황:"\uD83D\uDE33",혐오:"\uD83E\uDD22",설렘:"\uD83D\uDE0D",불편함:"\uD83D\uDE2C",혼란:"\uD83E\uDD2F",평온함:"\uD83D\uDE07",고민중:"\uD83E\uDD14",위로:"\uD83E\uDD17",무감정:"\uD83D\uDE36",격노:"\uD83E\uDD2C"},x=e=>{let{diaries:t,onEdit:r,onDelete:i}=e,l=e=>{let t=document.getElementById("diary-".concat(e));t&&d()(t,{scale:2}).then(e=>{let t=document.createElement("a");t.download="일기.png",t.href=e.toDataURL(),t.click()})};return(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,n.jsxs)("div",{style:{marginTop:"2rem",maxHeight:"500px",overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,n.jsx)("h2",{style:{textAlign:"center"},children:"\uD83D\uDCD8 일기 목록"}),0===t.length?(0,n.jsx)("p",{children:"일기가 없습니다."}):t.map(e=>{let{id:t,text:s,emotion:a,date:o}=e;return(0,n.jsxs)("div",{id:"diary-".concat(t),style:{backgroundColor:"#e6f2ff",borderRadius:"12px",padding:"1rem",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",maxWidth:"500px",width:"100%",display:"flex",flexDirection:"column",boxSizing:"border-box",gap:"0.75rem"},children:[(0,n.jsxs)("div",{style:{fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,n.jsx)("span",{children:c[a]||a}),(0,n.jsxs)("span",{style:{color:"#555"},children:["| ",new Date(o).toLocaleDateString()]})]}),(0,n.jsx)("div",{style:{fontSize:"1.1rem",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:s}),(0,n.jsxs)("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",flexWrap:"wrap"},children:[(0,n.jsx)("button",{onClick:()=>r(t),children:"✏️ 수정"}),(0,n.jsx)("button",{onClick:()=>i(t),style:{backgroundColor:"#f44336",color:"white"},children:"\uD83D\uDDD1️ 삭제"}),(0,n.jsx)("button",{onClick:()=>l(t),style:{backgroundColor:"#2196f3",color:"white"},children:"\uD83D\uDCF8 이미지로 저장"})]})]},t)})]})})};var u=r(2490);r(7854);let h={"\uD83D\uDE0A":"기쁨","\uD83D\uDE22":"슬픔","\uD83D\uDE20":"화남","\uD83D\uDE28":"불안","❤️":"사랑","\uD83D\uDE0E":"자신감","\uD83D\uDE2D":"눈물","\uD83D\uDE34":"피곤함","\uD83D\uDE33":"당황","\uD83E\uDD22":"혐오","\uD83D\uDE0D":"설렘","\uD83D\uDE2C":"불편함","\uD83E\uDD2F":"혼란","\uD83D\uDE07":"평온함","\uD83E\uDD14":"고민중","\uD83E\uDD17":"위로","\uD83D\uDE36":"무감정","\uD83E\uDD2C":"격노"},m=e=>{let{diaries:t}=e,r=t.reduce((e,t)=>{let r=new Date(t.date).toDateString(),n=Object.keys(h).find(e=>t.emotion===e||h[e]===t.emotion)||"❓";return e[r]||(e[r]=n),e},{});return(0,n.jsxs)("div",{style:{minWidth:"350px"},children:[(0,n.jsx)("h3",{style:{textAlign:"center"},children:"\uD83D\uDCC5 감정 달력"}),(0,n.jsx)(u.Ay,{tileContent:e=>{let{date:t}=e,i=r[t.toDateString()];return i?(0,n.jsx)("div",{style:{fontSize:"1.2rem",lineHeight:"1.2"},children:i}):null}})]})},p="diaries";function j(){return new Promise((e,t)=>{let r=indexedDB.open("diaryDB",1);r.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(p)||t.createObjectStore(p,{keyPath:"id",autoIncrement:!0})},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})}async function y(){let e=await j();return new Promise((t,r)=>{let n=e.transaction(p,"readonly").objectStore(p).getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})}async function g(e){let t=await j();return new Promise((r,n)=>{let i=t.transaction(p,"readwrite");i.objectStore(p).add(e),i.oncomplete=()=>r(),i.onerror=()=>n(i.error)})}async function f(e){let t=await j();return new Promise((r,n)=>{let i=t.transaction(p,"readwrite");i.objectStore(p).put(e),i.oncomplete=()=>r(),i.onerror=()=>n(i.error)})}async function b(e){let t=await j();return new Promise((r,n)=>{let i=t.transaction(p,"readwrite");i.objectStore(p).delete(e),i.oncomplete=()=>r(),i.onerror=()=>n(i.error)})}var D=r(7989),w=r(7634),v=r(747),C=r(1874);let S=["#FFCC00","#00C49F","#FF6F61","#FF9F00","#8884d8","#FFA07A","#98FB98","#DDA0DD"],k={"\uD83D\uDE0A":"기쁨","\uD83D\uDE22":"슬픔","\uD83D\uDE20":"화남","\uD83D\uDE28":"불안","❤️":"사랑","\uD83D\uDE0E":"자신감","\uD83D\uDE2D":"눈물","\uD83D\uDE34":"피곤함","\uD83D\uDE33":"당황","\uD83E\uDD22":"혐오","\uD83D\uDE0D":"설렘","\uD83D\uDE2C":"불편함","\uD83E\uDD2F":"혼란","\uD83D\uDE07":"평온함","\uD83E\uDD14":"고민중","\uD83E\uDD17":"위로","\uD83D\uDE36":"무감정","\uD83E\uDD2C":"격노"},A=e=>{let{diaries:t}=e,r=e=>{if(k[e])return e;let t=Object.entries(k).find(t=>{let[,r]=t;return r===e});return t?t[0]:e},i=Object.entries(t.reduce((e,t)=>{let{emotion:n}=t,i=k[r(n)]||"기타";return e[i]=(e[i]||0)+1,e},{})).map((e,t)=>{var r;let[n,i]=e;return{name:n,value:i,emoji:(null==(r=Object.entries(k).find(e=>{let[,t]=e;return t===n}))?void 0:r[0])||"❓"}});return(0,n.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,n.jsx)("h3",{children:"\uD83D\uDCCA 감정 분포 통계"}),0===i.length?(0,n.jsx)("p",{children:"아직 통계를 낼 데이터가 없습니다."}):(0,n.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"2rem"},children:[(0,n.jsxs)("div",{id:"emotion-chart",style:{textAlign:"center"},children:[(0,n.jsxs)(D.r,{width:400,height:300,children:[(0,n.jsx)(w.F,{data:i,dataKey:"value",nameKey:"name",outerRadius:100,label:e=>{var t;let{name:r,x:l,y:s}=e;return(0,n.jsxs)("text",{x:l,y:s,textAnchor:"middle",dominantBaseline:"central",fontSize:18,children:[null==(t=i.find(e=>e.name===r))?void 0:t.emoji," ",r]})},children:i.map((e,t)=>(0,n.jsx)(v.f,{fill:S[t%S.length]},"cell-".concat(t)))}),(0,n.jsx)(C.m,{})]}),(0,n.jsx)("button",{onClick:()=>{let e=document.getElementById("emotion-chart");e&&d()(e,{scale:3}).then(e=>{let t=document.createElement("a");t.download="감정통계.png",t.href=e.toDataURL(),t.click()})},style:{marginTop:"1rem",padding:"0.4rem 1rem",backgroundColor:"#4caf50",color:"white",border:"none",borderRadius:"10px",cursor:"pointer"},children:"\uD83D\uDCF7 이미지로 저장"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{children:"감정별 횟수"}),(0,n.jsxs)("table",{style:{borderCollapse:"collapse",width:"200px"},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{borderBottom:"1px solid #ccc",textAlign:"left"},children:"감정"}),(0,n.jsx)("th",{style:{borderBottom:"1px solid #ccc",textAlign:"right"},children:"횟수"})]})}),(0,n.jsx)("tbody",{children:i.map(e=>{let{name:t,value:r,emoji:i}=e;return(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{children:[i," ",t]}),(0,n.jsx)("td",{style:{textAlign:"right"},children:r})]},t)})})]})]})]})]})};function F(){let[e,t]=(0,i.useState)([]),[r,l]=(0,i.useState)("diary");(0,i.useEffect)(()=>{y().then(t)},[]);let s=async e=>{await g({...e,date:new Date().toISOString()}),t(await y())},o=async(r,n)=>{let i=e.map(e=>e.id===r?{...e,text:n}:e);await f(i.find(e=>e.id===r)),t(i)},d=async e=>{await b(e),t(await y())};return(0,n.jsxs)("div",{style:{backgroundColor:"#fff8f2",minHeight:"100vh",padding:"2rem 1rem",maxWidth:"1200px",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,n.jsxs)("header",{style:{textAlign:"center",marginBottom:"1.5rem"},children:[(0,n.jsx)("h1",{style:{fontSize:"2rem"},children:"\uD83C\uDFEB 신항초 3학년 Ai마음일기"}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem",marginTop:"0.5rem"},children:[(0,n.jsx)("button",{onClick:()=>l("diary"),style:{backgroundColor:"diary"===r?"#FFD966":"#EDEDED",border:"none",padding:"0.5rem 1rem",borderRadius:"10px"},children:"✍️ 일기"}),(0,n.jsx)("button",{onClick:()=>l("stats"),style:{backgroundColor:"stats"===r?"#FFD966":"#EDEDED",border:"none",padding:"0.5rem 1rem",borderRadius:"10px"},children:"\uD83D\uDCCA 통계"})]})]}),"diary"===r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{width:"100%",maxWidth:"800px"},children:(0,n.jsx)(a,{onAdd:s})}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",gap:"2rem",width:"100%",maxWidth:"1100px",marginTop:"2rem",alignItems:"flex-start",flexWrap:"wrap"},children:[(0,n.jsx)("div",{style:{flex:1,minWidth:"320px"},children:(0,n.jsx)(x,{diaries:e,onEdit:o,onDelete:d})}),(0,n.jsx)("div",{style:{minWidth:"350px"},children:(0,n.jsx)(m,{diaries:e})})]})]}),"stats"===r&&(0,n.jsx)("div",{style:{textAlign:"center",marginTop:"2rem",fontSize:"1.2rem"},children:(0,n.jsx)(A,{diaries:e})})]})}},2936:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(1300)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[366,672,636,593,792],()=>t(2936)),_N_E=e.O()}]);